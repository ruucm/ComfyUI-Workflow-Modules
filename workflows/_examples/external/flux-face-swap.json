{"last_node_id":162,"last_link_id":318,"nodes":[{"id":10,"type":"VAELoader","pos":[-644,-609],"size":{"0":315,"1":58},"flags":{"collapsed":true},"order":0,"mode":0,"inputs":[],"outputs":[{"name":"VAE","type":"VAE","links":[149,271],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"VAELoader"},"widgets_values":["ae.sft"]},{"id":74,"type":"UnetLoaderGGUF","pos":[-1003,-205],"size":{"0":315,"1":58},"flags":{},"order":1,"mode":0,"inputs":[],"outputs":[{"name":"MODEL","type":"MODEL","links":[317,318],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"UnetLoaderGGUF"},"widgets_values":["flux1-dev-Q4_K_S.gguf"]},{"id":82,"type":"DualCLIPLoaderGGUF","pos":[-1000,-95],"size":{"0":386.2881164550781,"1":106},"flags":{"collapsed":false},"order":2,"mode":0,"inputs":[],"outputs":[{"name":"CLIP","type":"CLIP","links":[314,315,316],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"DualCLIPLoaderGGUF"},"widgets_values":["t5-v1_1-xxl-encoder-Q4_K_S.gguf","clip_l.safetensors","flux"]},{"id":87,"type":"KSampler","pos":[-153,-439],"size":{"0":315,"1":474},"flags":{},"order":12,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":318},{"name":"positive","type":"CONDITIONING","link":147},{"name":"negative","type":"CONDITIONING","link":279},{"name":"latent_image","type":"LATENT","link":263}],"outputs":[{"name":"LATENT","type":"LATENT","links":[224],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[0,"fixed",20,1,"euler","simple",1]},{"id":89,"type":"EmptySD3LatentImage","pos":[-500,58],"size":{"0":271.2806396484375,"1":106},"flags":{},"order":3,"mode":0,"inputs":[],"outputs":[{"name":"LATENT","type":"LATENT","links":[263],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"EmptySD3LatentImage"},"widgets_values":[1024,1024,1]},{"id":90,"type":"CLIPTextEncode","pos":[-560,-318],"size":{"0":400,"1":200},"flags":{},"order":9,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":314}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[146],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["Korean Female, portrait"]},{"id":91,"type":"FluxGuidance","pos":[-456,-438],"size":{"0":211.60000610351562,"1":58},"flags":{"collapsed":false},"order":11,"mode":0,"inputs":[{"name":"conditioning","type":"CONDITIONING","link":146}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[147,269],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"FluxGuidance"},"widgets_values":[3.5]},{"id":92,"type":"VAEDecode","pos":[-473,-608],"size":{"0":210,"1":46},"flags":{"collapsed":true},"order":13,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":224},{"name":"vae","type":"VAE","link":149}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[220,288,300],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":108,"type":"ReActorFaceSwap","pos":[-307,-608],"size":{"0":315,"1":358},"flags":{"collapsed":true},"order":14,"mode":0,"inputs":[{"name":"input_image","type":"IMAGE","link":220},{"name":"source_image","type":"IMAGE","link":265},{"name":"face_model","type":"FACE_MODEL","link":null},{"name":"face_boost","type":"FACE_BOOST","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[303],"slot_index":0,"shape":3},{"name":"FACE_MODEL","type":"FACE_MODEL","links":[],"slot_index":1,"shape":3}],"properties":{"Node name for S&R":"ReActorFaceSwap"},"widgets_values":[true,"inswapper_128.onnx","retinaface_resnet50","codeformer-v0.1.0.pth",0.8,0.5,"no","no","0","0",1]},{"id":134,"type":"Image Comparer (rgthree)","pos":{"0":699.5781860351562,"1":-399.11865234375,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"size":{"0":662.9462280273438,"1":770.2034301757812},"flags":{"collapsed":false},"order":19,"mode":0,"inputs":[{"name":"image_a","type":"IMAGE","link":284,"dir":3},{"name":"image_b","type":"IMAGE","link":305,"dir":3}],"outputs":[],"properties":{"comparer_mode":"Slide"},"widgets_values":[[{"name":"A","selected":true,"url":"/api/view?filename=rgthree.compare._temp_yhzjd_00003_.png&type=temp&subfolder=&rand=0.6682441553166998"},{"name":"B","selected":true,"url":"/api/view?filename=rgthree.compare._temp_yhzjd_00004_.png&type=temp&subfolder=&rand=0.7240515535467482"}]]},{"id":141,"type":"LoadImage","pos":[-992,-588],"size":{"0":315,"1":314},"flags":{},"order":4,"mode":0,"inputs":[],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[265],"slot_index":0,"shape":3},{"name":"MASK","type":"MASK","links":null,"slot_index":1,"shape":3}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["f4.png","image"]},{"id":142,"type":"UltralyticsDetectorProvider","pos":[-42,-564],"size":{"0":315,"1":78},"flags":{"collapsed":true},"order":5,"mode":0,"inputs":[],"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[268],"slot_index":0,"shape":3},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":null,"shape":3}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"]},{"id":145,"type":"AV_FaceDetailer","pos":[234,-578],"size":{"0":519,"1":1144},"flags":{"collapsed":true},"order":18,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":311},{"name":"model","type":"MODEL","link":317},{"name":"clip","type":"CLIP","link":316},{"name":"vae","type":"VAE","link":271},{"name":"positive","type":"CONDITIONING","link":269},{"name":"negative","type":"CONDITIONING","link":280},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":268},{"name":"sam_model_opt","type":"SAM_MODEL","link":null},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":null},{"name":"detailer_hook","type":"DETAILER_HOOK","link":null},{"name":"scheduler_func_opt","type":"SCHEDULER_FUNC","link":null}],"outputs":[{"name":"image","type":"IMAGE","links":[284,287],"slot_index":0,"shape":3},{"name":"cropped_refined","type":"IMAGE","links":[],"slot_index":1,"shape":6},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":null,"shape":6},{"name":"mask","type":"MASK","links":null,"shape":3},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":null,"shape":3},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6}],"properties":{"Node name for S&R":"AV_FaceDetailer"},"widgets_values":[512,true,1024,0,"fixed",20,1,"euler","simple",0.25,5,true,true,0.5,10,3,"center-1",0,0.93,0,0.7,"False",10,"",1,false,20,true]},{"id":146,"type":"CLIPTextEncode","pos":[-465,-531],"size":{"0":400,"1":200},"flags":{"collapsed":true},"order":10,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":315}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[279,280],"slot_index":0,"shape":3}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":[""]},{"id":151,"type":"SaveImage","pos":[1465.5792236328125,-383.5875244140625],"size":{"0":593.81298828125,"1":759.3833618164062},"flags":{},"order":17,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":306}],"outputs":[],"properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"]},{"id":152,"type":"SaveImage","pos":[2187.34765625,-384.29376220703125],"size":{"0":629.2744140625,"1":758.6717529296875},"flags":{},"order":20,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":287}],"outputs":[],"properties":{"Node name for S&R":"SaveImage"},"widgets_values":["ComfyUI"]},{"id":153,"type":"Note","pos":[219,-785],"size":{"0":266.6457824707031,"1":133.02206420898438},"flags":{},"order":6,"mode":0,"inputs":[],"outputs":[],"properties":{"text":""},"widgets_values":["Decrease denoise in FaceDetailer below if you feel the final image's face is too different from the desired swap face, increase for stronger changes.\nI recommend from 0.15 to 0.35 to be closest as possible to the original face.\n(The original face img that you choose from> \"Choose image for swap\".)"],"color":"#432","bgcolor":"#653"},{"id":154,"type":"Note","pos":[-1366,-149],"size":{"0":259.7460021972656,"1":66.59290313720703},"flags":{},"order":7,"mode":0,"inputs":[],"outputs":[],"properties":{"text":""},"widgets_values":["Any Flux GGUF, including Schnell, and NF4 models should work.\n"],"color":"#432","bgcolor":"#653"},{"id":155,"type":"Note","pos":[-544,-73],"size":{"0":353.48980712890625,"1":73.16848754882812},"flags":{},"order":8,"mode":0,"inputs":[],"outputs":[],"properties":{"text":""},"widgets_values":["Refine your prompt according to the characteristics of your chosen person's image. 512x512 resolution is also usable if you have low-end GPU."],"color":"#432","bgcolor":"#653"},{"id":156,"type":"PreviewImage","pos":[213,-403],"size":{"0":382.5880432128906,"1":432.6065368652344},"flags":{},"order":15,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":288}],"outputs":[],"properties":{"Node name for S&R":"PreviewImage"}},{"id":159,"type":"ReActorMaskHelper","pos":[-46,-607],"size":{"0":330,"1":454},"flags":{"collapsed":true},"order":16,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":300},{"name":"swapped_image","type":"IMAGE","link":303},{"name":"mask_optional","type":"MASK","link":null}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[305,306,311],"slot_index":0,"shape":3},{"name":"MASK","type":"MASK","links":null,"shape":3},{"name":"MASK_PREVIEW","type":"IMAGE","links":null,"shape":3},{"name":"SWAPPED_FACE","type":"IMAGE","links":null,"shape":3}],"properties":{"Node name for S&R":"ReActorMaskHelper"},"widgets_values":["bbox/face_yolov8m.pt",0.5,10,3,10,"sam_vit_b_01ec64.pth",0,0.93,0,0.7,"False","dilate",0,9,1]}],"links":[[146,90,0,91,0,"CONDITIONING"],[147,91,0,87,1,"CONDITIONING"],[149,10,0,92,1,"VAE"],[220,92,0,108,0,"IMAGE"],[224,87,0,92,0,"LATENT"],[263,89,0,87,3,"LATENT"],[265,141,0,108,1,"IMAGE"],[268,142,0,145,6,"BBOX_DETECTOR"],[269,91,0,145,4,"CONDITIONING"],[271,10,0,145,3,"VAE"],[279,146,0,87,2,"CONDITIONING"],[280,146,0,145,5,"CONDITIONING"],[284,145,0,134,0,"IMAGE"],[287,145,0,152,0,"IMAGE"],[288,92,0,156,0,"IMAGE"],[300,92,0,159,0,"IMAGE"],[303,108,0,159,1,"IMAGE"],[305,159,0,134,1,"IMAGE"],[306,159,0,151,0,"IMAGE"],[311,159,0,145,0,"IMAGE"],[314,82,0,90,0,"CLIP"],[315,82,0,146,0,"CLIP"],[316,82,0,145,2,"CLIP"],[317,74,0,145,1,"MODEL"],[318,74,0,87,0,"MODEL"]],"groups":[{"title":"Face Swap Only","bounding":[1449,-481,648,919],"color":"#3f789e","font_size":24,"locked":false},{"title":"Final Result - Face Swap + Flux Face Reconstruction (FaceDetailer)","bounding":[2162,-483,733,924],"color":"#3f789e","font_size":24,"locked":false},{"title":"Compare FaceSwap Only and w/ Face Reconstruction","bounding":[655,-494,760,918],"color":"#3f789e","font_size":24,"locked":false},{"title":"Choose Image for Swap","bounding":[-1004,-669,345,411],"color":"#3f789e","font_size":24,"locked":false},{"title":"RAW Image (No changes)","bounding":[196,-492,426,625],"color":"#3f789e","font_size":24,"locked":false}],"config":{},"extra":{"ds":{"scale":0.5559917313492242,"offset":[1274.2966690915148,966.8173190556694]},"workspace_info":{"id":"X7OZcYfD9bIh0UmHCsIIA"}},"version":0.4}